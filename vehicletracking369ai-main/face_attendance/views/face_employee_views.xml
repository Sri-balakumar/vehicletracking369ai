<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Inherit hr.employee form to add Face Registration tab -->
    <record id="view_employee_form_face" model="ir.ui.view">
        <field name="name">hr.employee.form.face</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Face Recognition" name="face_recognition">
                    <group>
                        <group string="Face Registration">
                            <field name="face_image" widget="image" class="oe_avatar"
                                   options="{'size': [200, 200]}"/>
                            <field name="face_registered" readonly="1"
                                   widget="boolean_toggle"/>
                        </group>
                        <group string="Info">
                            <div class="text-muted" colspan="2">
                                <p><strong>How to register:</strong></p>
                                <ol>
                                    <li>Upload a clear front-facing photo above</li>
                                    <li>Run the camera script - it will auto-compute the face encoding</li>
                                    <li>Once registered, the employee will be detected automatically at the door</li>
                                </ol>
                            </div>
                        </group>
                    </group>
                    <group string="Technical (Face Encoding)" invisible="not face_encoding">
                        <field name="face_encoding" readonly="1" widget="text"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Employee list view with face status -->
    <record id="view_employee_tree_face" model="ir.ui.view">
        <field name="name">hr.employee.tree.face</field>
        <field name="model">hr.employee</field>
        <field name="arch" type="xml">
            <tree string="Face Registration">
                <field name="name"/>
                <field name="department_id"/>
                <field name="job_title"/>
                <field name="face_registered" widget="boolean_toggle" readonly="1"/>
                <field name="face_image" widget="image" options="{'size': [40, 40]}"/>
            </tree>
        </field>
    </record>

    <!-- Action for face registration list -->
    <record id="action_face_registration" model="ir.actions.act_window">
        <field name="name">Face Registration</field>
        <field name="res_model">hr.employee</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_employee_tree_face"/>
        <field name="context">{'search_default_group_department': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No employees found
            </p>
            <p>
                Go to Employees to add staff, then come back here to register their faces.
            </p>
        </field>
    </record>

</odoo>
